{
    "funding_sources": {
        "corelightningrest": {
            "class": "CoreLightningRestWallet",
            "settings": {
                "corelightning_rest_url": "http://127.0.0.1:8555",
                "corelightning_rest_macaroon": "eNcRyPtEdMaCaRoOn"
            }
        },
        "lndrest": {
            "class": "LndRestWallet",
            "settings": {
                "lnd_rest_endpoint": "http://127.0.0.1:8555",
                "lnd_rest_macaroon": "eNcRyPtEdMaCaRoOn",
                "lnd_rest_cert": ""
            }
        }
    },
    "functions": {
        "status": {
            "mocks": {
                "corelightningrest": {
                    "status_endpoint": {
                        "uri": "/v1/channel/localremotebal",
                        "headers": {
                            "macaroon": "eNcRyPtEdMaCaRoOn",
                            "encodingtype": "hex",
                            "accept": "application/json",
                            "User-Agent": "LNbits/Tests"
                        },
                        "method": "GET"
                    }
                },
                "lndrest": {
                    "status_endpoint": {
                        "uri": "/v1/balance/channels",
                        "headers": {
                            "Grpc-Metadata-macaroon": "eNcRyPtEdMaCaRoOn",
                            "User-Agent": "LNbits/Tests"
                        },
                        "method": "GET"
                    }
                }
            },
            "tests": [
                {
                    "description": "no balance",
                    "call_params": {},
                    "expect": {
                        "error_message": "no data",
                        "balance_msat": 0
                    },
                    "mocks": {
                        "corelightningrest": {
                            "status_endpoint": {
                                "response_type": "json",
                                "response": {}
                            }
                        },
                        "lndrest": {
                            "status_endpoint": {
                                "response_type": "json",
                                "response": {}
                            }
                        }
                    }
                },
                {
                    "description": "with balance",
                    "call_params": {},
                    "expect": {
                        "error_message": null,
                        "balance_msat": 55000
                    },
                    "mocks": {
                        "corelightningrest": {
                            "status_endpoint": {
                                "response_type": "json",
                                "response": {
                                    "localBalance": 55
                                }
                            }
                        },
                        "lndrest": {
                            "status_endpoint": {
                                "response_type": "json",
                                "response": {
                                    "balance": 55
                                }
                            }
                        }
                    }
                },
                {
                    "description": "with error",
                    "call_params": {},
                    "expect": {
                        "error_message": "Server error: '\"test-error\"'",
                        "balance_msat": 0
                    },
                    "mocks": {
                        "corelightningrest": {
                            "status_endpoint": {
                                "response_type": "json",
                                "response": {
                                    "error": "\"test-error\""
                                }
                            }
                        },
                        "lndrest": {
                            "status_endpoint": {
                                "response_type": "json",
                                "response": "test-error"
                            }
                        }
                    }
                },
                {
                    "description": "with bad json",
                    "call_params": {},
                    "expect": {
                        "error_message": "Server error: 'invalid json response'",
                        "balance_msat": 0
                    },
                    "mocks": {
                        "corelightningrest": {
                            "status_endpoint": {
                                "response_type": "data",
                                "response": {
                                    "error": "test-error"
                                }
                            }
                        },
                        "lndrest": {
                            "status_endpoint": {
                                "response_type": "data",
                                "response": {
                                    "error": "test-error"
                                }
                            }
                        }
                    }
                },
                {
                    "description": "http 404",
                    "call_params": {},
                    "expect": {
                        "error_message": "Unable to connect to http://127.0.0.1:8555.",
                        "balance_msat": 0
                    },
                    "mocks": {
                        "corelightningrest": {
                            "status_endpoint": {
                                "response_type": "response",
                                "response": {
                                    "response": "Not Found",
                                    "status": 404
                                }
                            }
                        },
                        "lndrest": {
                            "status_endpoint": {
                                "response_type": "response",
                                "response": {
                                    "response": "Not Found",
                                    "status": 404
                                }
                            }
                        }
                    }
                },
                {
                    "description": "no mocks",
                    "call_params": {},
                    "expect": {
                        "error_message": "Unable to connect to http://127.0.0.1:8555.",
                        "balance_msat": 0
                    }
                }
            ]
        },
        "create_invoice": {
            "mocks": {
                "corelightningrest": {
                    "create_invoice_endpoint": {
                        "uri": "/v1/invoice/genInvoice",
                        "headers": {
                            "macaroon": "eNcRyPtEdMaCaRoOn",
                            "encodingtype": "hex",
                            "accept": "application/json",
                            "User-Agent": "LNbits/Tests"
                        },
                        "method": "POST"
                    }
                },
                "lndrest": {
                    "create_invoice_endpoint": {
                        "uri": "/v1/invoices",
                        "headers": {
                            "Grpc-Metadata-macaroon": "eNcRyPtEdMaCaRoOn",
                            "User-Agent": "LNbits/Tests"
                        },
                        "method": "POST"
                    }
                }
            },
            "tests": [
                {
                    "description": "success",
                    "call_params": {
                        "amount": 555,
                        "memo": "Test Invoice",
                        "label": "test-label"
                    },
                    "expect": {
                        "success": true,
                        "checking_id": "e35526a43d04e985594c0dfab848814f524b1c786598ec9a63beddb2d726ac96",
                        "payment_request": "lnbc5550n1pnq9jg3sp52rvwstvjcypjsaenzdh0h30jazvzsf8aaye0julprtth9kysxtuspp5e5s3z7felv4t9zrcc6wpn7ehvjl5yzewanzl5crljdl3jgeffyhqdq2f38xy6t5wvxqzjccqpjrzjq0yzeq76ney45hmjlnlpvu0nakzy2g35hqh0dujq8ujdpr2e42pf2rrs6vqpgcsqqqqqqqqqqqqqqeqqyg9qxpqysgqwftcx89k5pp28435pgxfl2vx3ksemzxccppw2j9yjn0ngr6ed7wj8ztc0d5kmt2mvzdlcgrludhz7jncd5l5l9w820hc4clpwhtqj3gq62g66n",
                        "error_message": null
                    },
                    "mocks": {
                        "corelightningrest": {
                            "create_invoice_endpoint": {
                                "request_type": "data",
                                "request_body": {
                                    "amount": 555000,
                                    "description": "Test Invoice",
                                    "label": "test-label"
                                },
                                "response_type": "json",
                                "response": {
                                    "payment_hash": "e35526a43d04e985594c0dfab848814f524b1c786598ec9a63beddb2d726ac96",
                                    "bolt11": "lnbc5550n1pnq9jg3sp52rvwstvjcypjsaenzdh0h30jazvzsf8aaye0julprtth9kysxtuspp5e5s3z7felv4t9zrcc6wpn7ehvjl5yzewanzl5crljdl3jgeffyhqdq2f38xy6t5wvxqzjccqpjrzjq0yzeq76ney45hmjlnlpvu0nakzy2g35hqh0dujq8ujdpr2e42pf2rrs6vqpgcsqqqqqqqqqqqqqqeqqyg9qxpqysgqwftcx89k5pp28435pgxfl2vx3ksemzxccppw2j9yjn0ngr6ed7wj8ztc0d5kmt2mvzdlcgrludhz7jncd5l5l9w820hc4clpwhtqj3gq62g66n"
                                }
                            }
                        },
                        "lndrest": {
                            "create_invoice_endpoint": {
                                "request_type": "json",
                                "request_body": {
                                    "value": 555,
                                    "memo": "Test Invoice",
                                    "private": true
                                },
                                "response_type": "json",
                                "response": {
                                    "r_hash": "41UmpD0E6YVZTA36uEiBT1JLHHhlmOyaY77dstcmrJY=",
                                    "payment_request": "lnbc5550n1pnq9jg3sp52rvwstvjcypjsaenzdh0h30jazvzsf8aaye0julprtth9kysxtuspp5e5s3z7felv4t9zrcc6wpn7ehvjl5yzewanzl5crljdl3jgeffyhqdq2f38xy6t5wvxqzjccqpjrzjq0yzeq76ney45hmjlnlpvu0nakzy2g35hqh0dujq8ujdpr2e42pf2rrs6vqpgcsqqqqqqqqqqqqqqeqqyg9qxpqysgqwftcx89k5pp28435pgxfl2vx3ksemzxccppw2j9yjn0ngr6ed7wj8ztc0d5kmt2mvzdlcgrludhz7jncd5l5l9w820hc4clpwhtqj3gq62g66n"
                                }
                            }
                        }
                    }
                },
                {
                    "description": "error",
                    "call_params": {
                        "amount": 555,
                        "memo": "Test Invoice",
                        "label": "test-label"
                    },
                    "expect": {
                        "success": false,
                        "checking_id": null,
                        "payment_request": null,
                        "error_message": "Server error: 'Test Error'"
                    },
                    "mocks": {
                        "corelightningrest": {
                            "create_invoice_endpoint": {
                                "request_type": "data",
                                "request_body": {
                                    "amount": 555000,
                                    "description": "Test Invoice",
                                    "label": "test-label"
                                },
                                "response_type": "json",
                                "response": {
                                    "error": "Test Error"
                                }
                            }
                        },
                        "lndrest": {
                            "create_invoice_endpoint": {
                                "request_type": "json",
                                "request_body": {
                                    "value": 555,
                                    "memo": "Test Invoice",
                                    "private": true
                                },
                                "response_type": "json",
                                "response": {
                                    "error": "Test Error"
                                }
                            }
                        }
                    }
                },
                {
                    "description": "http 404",
                    "call_params": {
                        "amount": 555,
                        "memo": "Test Invoice",
                        "label": "test-label"
                    },
                    "expect": {
                        "success": false,
                        "checking_id": null,
                        "payment_request": null,
                        "error_message": "Unable to connect to http://127.0.0.1:8555."
                    },
                    "mocks": {
                        "corelightningrest": {
                            "create_invoice_endpoint": {
                                "request_type": "data",
                                "request_body": {
                                    "amount": 555000,
                                    "description": "Test Invoice",
                                    "label": "test-label"
                                },
                                "response_type": "response",
                                "response": {
                                    "response": "Not Found",
                                    "status": 404
                                }
                            }
                        },
                        "lndrest": {
                            "create_invoice_endpoint": {
                                "request_type": "json",
                                "request_body": {
                                    "value": 555,
                                    "memo": "Test Invoice",
                                    "private": true
                                },
                                "response_type": "response",
                                "response": {
                                    "response": "Not Found",
                                    "status": 404
                                }
                            }
                        }
                    }
                }
            ]
        }
    }
}
